{% extends "base.html" %}

{% block title %}
Свободные теннисные слоты Москвы
{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h1 class="h3 mb-3">Свободные теннисные слоты</h1>
        <p class="text-muted mb-0">
            Единый поиск по клубам Москвы. В ближайшем будущем здесь будут работать фильтры,
            обновление статусов и уведомления в Telegram.
        </p>
    </div>
</div>

<!-- Блок фильтров -->
<div class="card mb-4 shadow-sm">
    <div class="card-body">
        <form class="row g-3" id="filters-form">
            <div class="col-md-3">
                <label class="form-label">Дата</label>
                <input type="date" class="form-control" name="date">
            </div>

            <div class="col-md-3">
                <label class="form-label">Время</label>
                <div class="input-group">
                    <input type="time" class="form-control" name="time_from" placeholder="с">
                    <span class="input-group-text">–</span>
                    <input type="time" class="form-control" name="time_to" placeholder="до">
                </div>
                <div class="form-text">Например, с 18:00 до 22:00</div>
            </div>

            <div class="col-md-3">
                <label class="form-label">Минимальная длительность</label>
                <select class="form-select" name="min_duration">
                    <option value="">Не важно</option>
                    <option value="60">1 час</option>
                    <option value="90">1.5 часа</option>
                    <option value="120">2 часа</option>
                </select>
            </div>

            <div class="col-md-3">
                <label class="form-label">Клуб</label>
                <select class="form-select" name="club">
                    <option value="">Все клубы</option>
                    <option value="Tsaritsyno Tennis">Tsaritsyno Tennis</option>
                    <option value="MosTennis Club">MosTennis Club</option>
                    <option value="YClients Arena">YClients Arena</option>
                </select>
            </div>

            <div class="col-md-3">
                <div class="form-check mt-4 pt-2">
                    <input class="form-check-input" type="checkbox" value="free_only" id="freeOnly" checked>
                    <label class="form-check-label" for="freeOnly">
                        Показывать только свободные слоты
                    </label>
                </div>
            </div>

            <div class="col-md-9 text-end align-self-end">
                <button
                    type="button"
                    class="btn btn-outline-secondary me-2"
                    id="reset-filters-btn"
                >
                    Сбросить
                </button>
                <button
                    type="button"
                    class="btn btn-primary"
                    id="apply-filters-btn"
                >
                    Применить фильтры
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Таблица слотов -->
<div class="card shadow-sm">
    <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="h5 mb-0">Найденные слоты</h2>
            <button
                type="button"
                class="btn btn-sm btn-outline-primary"
                id="refresh-slots-btn"
            >
                Обновить статусы
            </button>
        </div>

        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th scope="col">Дата</th>
                        <th scope="col">Время</th>
                        <th scope="col">Длительность</th>
                        <th scope="col">Клуб</th>
                        <th scope="col">Корт</th>
                        <th scope="col">Статус</th>
                        <th scope="col">Источник</th>
                    </tr>
                </thead>
                <tbody id="slots-table-body">
                {% for slot in slots %}
                    <tr>
                        <td>{{ slot.start.strftime('%d.%m.%Y') }}</td>
                        <td>{{ slot.start.strftime('%H:%M') }}–{{ slot.end.strftime('%H:%M') }}</td>
                        <td>{{ slot.duration_minutes }} мин</td>
                        <td>{{ slot.club }}</td>
                        <td>{{ slot.court }}</td>
                        <td>
                            {% if slot.status == 'free' %}
                                <span class="badge bg-success">Свободен</span>
                            {% else %}
                                <span class="badge bg-secondary">Занят</span>
                            {% endif %}
                        </td>
                        <td>
                            <span class="badge bg-light text-muted border">
                                {{ slot.source }}
                            </span>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="7" class="text-center text-muted py-4">
                            Нет слотов для отображения
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
